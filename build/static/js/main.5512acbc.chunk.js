(this["webpackJsonpreact-temp"]=this["webpackJsonpreact-temp"]||[]).push([[0],{1009:function(e,t){},1161:function(e,t,n){"use strict";n.r(t);var a=n(101),r=n(707),c=n(0),o=n.n(c),i=n(30),s=n.n(i),u=n(64),p=n.n(u),l=n(116),f=n(701),d=n(702),j=n(709),m=n(708),b=n(173),O=n(119),g=n(195),w=n(10),h=n(74),x=n(67),v=function(){var e=Object(l.a)(p.a.mark((function e(t,n){var a,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.time,r="https://95gc0kospc.execute-api.ca-central-1.amazonaws.com/prod/alerts?radius=450000000&lat=43.7425651&long=-79.2148452&time=".concat(void 0===a?1:a,"&writeLocation=false"),e.next=4,fetch(r).then((function(e){return e.json()}));case 4:c=e.sent,o=c.map((function(e){return new h.default(Object(g.a)(Object(g.a)({name:"".concat(e.provider.toUpperCase()," ").concat(new Date(e.timestamp))},Object(g.a)(Object(g.a)({},e),e.data)),{},{timestamp:new Date(e.timestamp),geometry:new x.default(Object(w.fromLonLat)([e.long,e.lat]))}))})),t.getSource().clear(),t.getSource().addFeatures(o);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=n(71),k=n(87),S=n(208),C=function(){var e=Object(l.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://95gc0kospc.execute-api.ca-central-1.amazonaws.com/prod/locations",e.next=3,fetch("https://95gc0kospc.execute-api.ca-central-1.amazonaws.com/prod/locations").then((function(e){return e.json()}));case 3:n=e.sent,t.getSource().clear(),a=n.map((function(e){var t=new h.default(Object(g.a)(Object(g.a)({name:e.userid},e),{},{timestamp:new Date(e.timestamp),geometry:new x.default(Object(w.fromLonLat)([e.long,e.lat]))})),n=new y.default({stroke:new k.default,image:new S.default({opacity:1,src:"https://image.flaticon.com/icons/png/512/89/89132.png",scale:.05})});return t.setStyle(n),t})),t.getSource().addFeatures(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=n(158),D=n(706),I=n.n(D),A=n(1207),M={container:{position:"absolute",right:"15px",bottom:"80px",backgroundColor:"white",width:"300px",opacity:"0.8",borderRadius:"4px",padding:"10px",textAlign:"center",fontFamily:"sans-serif",fontSize:"1.5rem"},slider:{width:"250px",margin:"10px"}},z=Object(b.connectToContext)((function(e){var t=e.map,n=Object(c.useState)(1),r=Object(L.a)(n,2),o=r[0],i=r[1],s=Object(c.useState)((new Date).toISOString()),u=Object(L.a)(s,2),p=u[0],l=u[1],f=t.getLayers().getArray(),d=f.find((function(e){return"Driver"===e.get("title")})),j=f.find((function(e){return"Alerts"===e.get("title")})),m=Object(c.useCallback)((function(){console.log("new data fetched"),C(d),v(j,{time:o})}));Object(c.useEffect)((function(){console.log("using this effect"),setTimeout((function(){l((new Date).toISOString())}),3e4),m()}),[p]);return Object(a.jsxs)("div",{style:M.container,children:[Object(a.jsxs)("p",{children:[o," hours"]}),Object(a.jsx)("input",{style:M.slider,id:"radius",type:"range",min:"0.25",max:"10",step:"0.25",value:o,onChange:function(e){return t=e.target.value,void i(t);var t}}),Object(a.jsx)(A.a,{onClick:m,children:Object(a.jsx)(I.a,{})})]})})),F=function(e){Object(j.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onMapInit=function(){var e=Object(l.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new b.VectorLayer({title:"Alerts",source:new O.default({})}),a=new b.VectorLayer({title:"Driver",source:new O.default({})}),t.addLayer(a),t.addLayer(n),window.map=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}return Object(d.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(b.Map,{onMapInit:this.onMapInit,fullScreen:!0,children:[Object(a.jsx)(b.Popup,{}),Object(a.jsx)(b.ContextMenu,{}),Object(a.jsx)(z,{}),Object(a.jsx)(b.Controls,{}),Object(a.jsx)(b.BasemapContainer,{})]})}}]),n}(o.a.Component),B=Object(r.hot)(F);s.a.render(Object(a.jsx)(B,{}),document.getElementById("root"))}},[[1161,1,2]]]);
//# sourceMappingURL=main.5512acbc.chunk.js.map